<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カタカナ → 한국어 변환기</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #ffffff;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-size: 28px;
      color: #1a73e8;
    }
    textarea {
      width: 80%;
      height: 120px;
      font-size: 20px;
      margin: 10px 0;
      padding: 10px;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
      margin: 10px 0;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #output {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
      white-space: pre-wrap;
      word-break: break-word;
      background: #f5f5f5;
      padding: 15px;
      width: 80%;
      border-radius: 5px;
      min-height: 50px;
    }
  </style>
</head>
<body>
  <h1>カタカナ → 한국어 변환기</h1>
  <textarea id="input" placeholder="カタカナ를 입력하세요"></textarea>
  <button onclick="convert()">변환하기</button>
  <div id="output"></div>

  <script>
    /* ================================
       カタカナ → 한글 기본 매핑
       ================================ */
    const kanaMap = {
      "ア":"아","イ":"이","ウ":"우","エ":"에","オ":"오",
      "カ":"카","キ":"키","ク":"쿠","ケ":"케","コ":"코",
      "ガ":"가","ギ":"기","グ":"구","ゲ":"게","ゴ":"고",
      "サ":"사","シ":"시","ス":"스","セ":"세","ソ":"소",
      "ザ":"자","ジ":"지","ズ":"즈","ゼ":"제","ゾ":"조",
      "タ":"타","チ":"치","ツ":"츠","テ":"테","ト":"토",
      "ダ":"다","ヂ":"지","ヅ":"즈","デ":"데","ド":"도",
      "ナ":"나","ニ":"니","ヌ":"누","ネ":"네","ノ":"노",
      "ハ":"하","ヒ":"히","フ":"후","ヘ":"헤","ホ":"호",
      "バ":"바","ビ":"비","ブ":"부","ベ":"베","ボ":"보",
      "パ":"파","ピ":"피","プ":"푸","ペ":"페","ポ":"포",
      "マ":"마","ミ":"미","ム":"무","メ":"메","モ":"모",
      "ヤ":"야","ユ":"유","ヨ":"요",
      "ラ":"라","リ":"리","ル":"루","レ":"레","ロ":"로",
      "ワ":"와","ヲ":"오","ン":"ㄴ",
      "キャ":"캬","キュ":"큐","キョ":"쿄",
      "シャ":"샤","シュ":"슈","ショ":"쇼",
      "チャ":"챠","チュ":"추","チョ":"초",
      "ニャ":"냐","ニュ":"뉴","ニョ":"뇨",
      "ヒャ":"햐","ヒュ":"휴","ヒョ":"효",
      "ミャ":"먀","ミュ":"뮤","ミョ":"묘",
      "リャ":"랴","リュ":"류","リョ":"료",
      "ギャ":"갸","ギュ":"규","ギョ":"교",
      "ジャ":"쟈","ジュ":"쥬","ジョ":"조",
      "ビャ":"뱌","ビュ":"뷰","ビョ":"뵤",
      "ピャ":"퍄","ピュ":"퓨","ピョ":"표"
    };

    /* ================================
       외래어 + ッ + ン 규칙 처리
       ================================ */
    function applyKoreanPhonology(text) {
      return text
        // --- 외래어 확장: ヴ 계열 ---
        .replace(/ヴァ/g, "バ") // 바
        .replace(/ヴィ/g, "ビ") // 비
        .replace(/ヴェ/g, "ベ") // 베
        .replace(/ヴォ/g, "ボ") // 보
        .replace(/ヴ/g, "ブ")   // 부

        // --- 외래어 확장: ティ, ディ, etc ---
        .replace(/ティ/g, "チ") // 티
        .replace(/ディ/g, "ヂ") // 디
        .replace(/チェ/g, "チ") // 체
        .replace(/シェ/g, "シ") // 셰
        .replace(/ジェ/g, "ジ") // 제
        .replace(/ファ/g, "フ") // 파
        .replace(/フィ/g, "フ") // 피
        .replace(/フェ/g, "フ") // 페
        .replace(/フォ/g, "フ") // 포

        // --- 促音(ッ) 처리 (받침) ---
        .replace(/ッ([カキクケコ])/g, "ㄱ$1")
        .replace(/ッ([サシスセソ])/g, "ㅅ$1")
        .replace(/ッ([タチツテト])/g, "ㄷ$1")
        .replace(/ッ([パピプペポ])/g, "ㅂ$1")
        .replace(/ッ/g, "ㅅ")

        // --- 撥音(ン) 처리 ---
        .replace(/ン([カ-コサ-ソタ-トナ-ノハ-ホマ-モヤユヨラ-ロワヲ])/g, "ㄴ$1")
        .replace(/ン$/g, "ㄴ");
    }

    /* ================================
       カタカナ → 한글 변환 실행
       ================================ */
    function kanaToHangul(input) {
      let result = "";
      let i = 0;
      while (i < input.length) {
        let two = input.substr(i, 2);
        if (kanaMap[two]) {
          result += kanaMap[two];
          i += 2;
          continue;
        }
        let one = input[i];
        result += kanaMap[one] || one;
        i++;
      }
      return result;
    }

    function convert() {
      const input = document.getElementById("input").value.trim();

      // 1. 음운 규칙 적용 (외래어, ッ, ン 변환)
      let preHandled = applyKoreanPhonology(input);

      // 2. 카타카나 → 한글 매핑
      let output = kanaToHangul(preHandled);

      document.getElementById("output").innerText = output;
    }
  </script>
</body>
</html>
