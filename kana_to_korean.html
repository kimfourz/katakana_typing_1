<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カタカナ → 한국어 변환기</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #ffffff;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-size: 28px;
      color: #1a73e8;
    }
    textarea {
      width: 80%;
      height: 120px;
      font-size: 20px;
      margin: 10px 0;
      padding: 10px;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
      margin: 10px 0;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #output {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
      white-space: pre-wrap;
      word-break: break-word;
      background: #f5f5f5;
      padding: 15px;
      width: 80%;
      border-radius: 5px;
      min-height: 50px;
    }
  </style>
</head>
<body>
  <h1>カタカナ → 한국어 변환기</h1>
  <textarea id="input" placeholder="カタカナ를 입력하세요"></textarea>
  <button onclick="convert()">변환하기</button>
  <div id="output"></div>

  <script>
    /* ================================
       ッ(促音) 처리
       ================================ */
    function handleSokuon(input) {
      return input.replace(/ッ([カ-モサ-モタ-ドバ-ポ])/g, (m, next) => {
        if (/カ|キ|ク|ケ|コ|ガ|ギ|グ|ゲ|ゴ/.test(next)) return "ㄱ" + next;
        if (/サ|シ|ス|セ|ソ|ザ|ジ|ズ|ゼ|ゾ/.test(next)) return "ㅅ" + next;
        if (/タ|チ|ツ|テ|ト|ダ|ヂ|ヅ|デ|ド/.test(next)) return "ㄷ" + next;
        if (/パ|ピ|プ|ペ|ポ|バ|ビ|ブ|ベ|ボ/.test(next)) return "ㅂ" + next;
        return next;
      });
    }

    /* ================================
       카타카나 → 한글 변환 (기본 매핑)
       ================================ */
    const kanaMap = {
      "ア":"아","イ":"이","ウ":"우","エ":"에","オ":"오",
      "カ":"카","キ":"키","ク":"쿠","ケ":"케","コ":"코",
      "ガ":"가","ギ":"기","グ":"구","ゲ":"게","ゴ":"고",
      "サ":"사","シ":"시","ス":"스","セ":"세","ソ":"소",
      "ザ":"자","ジ":"지","ズ":"즈","ゼ":"제","ゾ":"조",
      "タ":"타","チ":"치","ツ":"츠","テ":"테","ト":"토",
      "ダ":"다","ヂ":"지","ヅ":"즈","デ":"데","ド":"도",
      "ナ":"나","ニ":"니","ヌ":"누","ネ":"네","ノ":"노",
      "ハ":"하","ヒ":"히","フ":"후","ヘ":"헤","ホ":"호",
      "バ":"바","ビ":"비","ブ":"부","ベ":"베","ボ":"보",
      "パ":"파","ピ":"피","プ":"푸","ペ":"페","ポ":"포",
      "マ":"마","ミ":"미","ム":"무","メ":"메","モ":"모",
      "ヤ":"야","ユ":"유","ヨ":"요",
      "ラ":"라","リ":"리","ル":"루","レ":"레","ロ":"로",
      "ワ":"와","ヲ":"오","ン":"ㄴ",
      "キャ":"캬","キュ":"큐","キョ":"쿄",
      "シャ":"샤","シュ":"슈","ショ":"쇼",
      "チャ":"챠","チュ":"추","チョ":"초",
      "ニャ":"냐","ニュ":"뉴","ニョ":"뇨",
      "ヒャ":"햐","ヒュ":"휴","ヒョ":"효",
      "ミャ":"먀","ミュ":"뮤","ミョ":"묘",
      "リャ":"랴","リュ":"류","リョ":"료",
      "ギャ":"갸","ギュ":"규","ギョ":"교",
      "ジャ":"쟈","ジュ":"쥬","ジョ":"조",
      "ビャ":"뱌","ビュ":"뷰","ビョ":"뵤",
      "ピャ":"퍄","ピュ":"퓨","ピョ":"표"
    };

    function kanaToHangul(input) {
      let result = "";
      let i = 0;
      while (i < input.length) {
        let two = input.substr(i, 2);
        if (kanaMap[two]) {
          result += kanaMap[two];
          i += 2;
          continue;
        }
        let one = input[i];
        result += kanaMap[one] || one;
        i++;
      }
      return result;
    }

    /* ================================
       한국어 음운 규칙 적용
       ================================ */
   function applyKoreanPhonology(text) {
return text
    // 기존 규칙들 유지
    .replace(/メㄴ/g, "멘")
    .replace(/ネㄴ/g, "넨")
    .replace(/テㄴ/g, "텐")

    // 받침화 규칙 보강
    .replace(/구ㄱ/g, "국")
    .replace(/구ㄷ/g, "굿")
    .replace(/부ㅂ/g, "붑")
    .replace(/부ㄷ/g, "붓")
    .replace(/도ㄷ/g, "돋")
    .replace(/가ㄷ/g, "갇")

    // ㄴ 계열
    .replace(/ㄴㄱ/g, "ㅇ")
    .replace(/ㄴㅂ/g, "ㅁ")
    .replace(/ㄴㅍ/g, "ㅁ")
    .replace(/ㄴㄷ/g, "ㄴㄴ")

    // --- 促音(ッ) 관련 받침화 규칙 ---
    // ㅅ 계열 (타행 + サ行)
    .replace(/세ㄷ토/g, "셋토")
    .replace(/아세ㄷ토/g, "아셋토")
    .replace(/라ㄷ토/g, "랏토")
    .replace(/푸라ㄷ토/g, "푸랏토")
    .replace(/도ㄷ테/g, "돗테")
    .replace(/사ㄷ소/g, "삿소")

        // ント → 멘토 / 넌토 / … 형태 변환
    .replace(/メㄴト/g, "멘토")
    .replace(/ネㄴト/g, "넨토")
    .replace(/ンㄴト/g, "ㄴ토")  // 일반 규칙 보정


    // ㄱ 계열 (カ行)
    .replace(/가ㄱ카/g, "각카")
    .replace(/마ㄱ코/g, "막코")
    .replace(/쿠ㄱ코/g, "쿡코")

    // ㅂ 계열 (パ行)
    .replace(/부ㅂ포/g, "붑포")
    .replace(/부ㄷ포/g, "붓포")
    .replace(/아ㅂ파/g, "압파")

    // ㄷ 계열 (タ行)
    .replace(/부ㄷ타/g, "붓타")
    .replace(/마ㄷ타/g, "맛타")

    // --- 일반 받침화 ---
    .replace(/구ㄷ/g, "굿")
    .replace(/부ㄷ/g, "붓")
    .replace(/도ㄷ/g, "돋")

    // ㄱ받침 + ㄷ → ㄳ (굿도 케이스)
    .replace(/굿도/g, "굿도")

    // 받침 + 모음 시작 → 붙이기
    .replace(/([가-힣])ㄴ([아-잏])/g, (m, prev, next) => prev + "ㄴ" + next);
}

    /* ================================
       변환 실행
       ================================ */
    function convert() {
      const input = document.getElementById("input").value.trim();

      let handled = handleSokuon(input);     // ッ 처리
      let raw = kanaToHangul(handled);       // 카타카나 → 한글
      let fixed = applyKoreanPhonology(raw); // 음운 규칙 적용

      document.getElementById("output").innerText = fixed;
    }
  </script>
</body>
</html>
