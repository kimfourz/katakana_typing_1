<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カタカナ タイピング</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #ffffff;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }
    header {
      width: 100%;
      display: flex;
      justify-content: flex-end;
      padding: 10px 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #logo {
      height: 80px;
    }
    .logo-wrapper {
      width: 100%;
      display: flex;
      justify-content: left;
      align-items: left;
      padding: 10px 0;
    }
    h1 {
      margin-top: 30px;
      font-size: 32px;
      color: #1a73e8;
    }
    #stageButtons button {
      font-size: 18px;
      padding: 10px 16px; /* 위아래 6px, 좌우 16px */
      margin: 10px 0; /* 버튼 사이 간격 */
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: auto; /* 폭 자동 */
      white-space: nowrap; /* 줄바꿈 방지 */
    }


    #stageButtons {
      display: flex;
      flex-direction: column; /* 세로로 나열 */
      align-items: center; /* 가운데 정렬 */
    }
    #game {
      margin-top: 40px;
      text-align: center;
    }
    #question {
      font-size: 48px;
      margin: 20px;
    }
    #question .kana {
      font-size: 56px;
      font-weight: bold;
      display: block;
    }
    #question .romaji {
      font-size: 24px;
      color: gray;
      margin-top: 5px;
      display: block;
    }
    #input {
      font-size: 24px;
      padding: 10px;
      width: 300px;
    }
    #feedback {
      margin: 20px;
      font-size: 20px;
      height: 30px;
    }
    #timer {
      font-size: 20px;
      color: red;
    }
    #result {
      font-size: 24px;
      margin: 40px;
    }
    .options {
      margin-top: 20px;
      font-size: 18px;
    }
    .options input {
      width: 60px;
      text-align: center;
    }
  </style>
</head>

<body>

<header>
  <div class="logo-wrapper">
    <img id="logo" src="kana.png" alt="Logo" />
  </div>
</header>

<h1>カタカナ タイピング ゲーム</h1>

<!-- 옵션 -->
<div class="options">
  라운드 수: <input type="number" id="roundCount" value="10" min="1" max="40"> 개
  &nbsp;&nbsp; 제한 시간: <input type="number" id="timeLimit" value="15" min="5" max="60"> 초
</div>

<!-- 단계 선택 버튼 -->
<div id="stageButtons"></div>

<div id="game" style="display:none;">
  <div id="timer">15</div>
  <div id="question">---</div>
  <input id="input" type="text" onkeydown="handleKey(event)" autocomplete="off" />
  <div id="feedback"></div>
</div>

<div id="result" style="display:none;">
  <div id="resultText"></div>
  <button onclick="restartGame()">🔁 다시 시작</button>
</div>

<script>
  const katakana = ["カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト","ナ","ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ","ル","レ","ロ"];
  const halfKatakanapractice = [
  // ✅ 기본 요음
  "キャ KYA","キュ KYU","キョ KYO",
  "シャ SHA","シュ SHU","ショ SHO",
  "チャ CHA","チュ CHU","チョ CHO",
  "ニャ NYA","ニュ NYU","ニョ NYO",
  "ヒャ HYA","ヒュ HYU","ヒョ HYO",
  "ミャ MYA","ミュ MYU","ミョ MYO",
  "リャ RYA","リュ RYU","リョ RYO",

  // ✅ 탁음 요음
  "ギャ GYA","ギュ GYU","ギョ GYO",
  "ジャ JA","ジュ JU","ジョ JO",
  "ヂャ JA","ヂュ JU","ヂョ JO", // 거의 안 쓰임
  "ビャ BYA","ビュ BYU","ビョ BYO",

  // ✅ 반탁음 요음
  "ピャ PYA","ピュ PYU","ピョ PYO",

  // ✅ 외래어 확장 요음
  "ファ FA","フィ FI","フェ FE","フォ FO",
  "ウィ WI","ウェ WE","ウォ WO",
  "クァ KWA","クィ KWI","クェ KWE","クォ KWO",
  "グァ GWA","グィ GWI","グェ GWE","グォ GWO",
  "ティ TI","トゥ TU",
  "チェ CHE","シェ SHE","ジェ JE",
  "ディ DI","ドゥ DU"
];

  const halfKatakana = [
  // 기본 요음
  "キャ","キュ","キョ",
  "シャ","シュ","ショ",
  "チャ","チュ","チョ",
  "ニャ","ニュ","ニョ",
  "ヒャ","ヒュ","ヒョ",
  "ミャ","ミュ","ミョ",
  "リャ","リュ","リョ",

  // 탁음 요음
  "ギャ","ギュ","ギョ",
  "ジャ","ジュ","ジョ",
  "ヂャ","ヂュ","ヂョ", // 거의 안 쓰임
  "ビャ","ビュ","ビョ",

  // 반탁음 요음
  "ピャ","ピュ","ピョ",

  // 외래어 확장 요음
  "ファ","フィ","フェ","フォ",
  "ウィ","ウェ","ウォ",
  "クァ","クィ","クェ","クォ",
  "グァ","グィ","グェ","グォ",
  "ティ","トゥ",
  "チェ","シェ","ジェ",
  "ディ","ドゥ"
];

  const fullWords = ["アイスクリーム","アイデア","アイロン","アウト","アクセサリー","アクセント","アジア","アドバイス","アドレス","アナウンサー","アナウンス","アニメ","アパート","アフリカ","アマチュア","アメリカ","アルコール","アルバイト","アルバム","アルミホイル","アレルギー","アンケート","アンテナ","イコール","イメージ","イヤリング","インキ","インク","インスタント","インタビュー","インターネット","ウイスキー","ウイルス","ウーマン","エアコン","エスカレーター","エチケット","エネルギー","エプロン","エレベーター","エンジン","オイル","オフィス","オペラ","オリンピック","オーケストラ","カセット","カタログ","カップ","カバー","カメラ","カラー","カレンダー","カレー","カロリー","カー","カーテン","カード","カーナビ","カーブ","カーペット","ガス","ガソリン","ガム","ガラス","キッチン","キャプテン","キャンセル","キャンパス","キャンプ","キロ","キログラム","キロメートル","ギター","ギャング","クイズ","クラシック","クラス","クラブ","クリスマス","クリック","クリーニング","クリーム","クーラー","グラス","グラム","グループ","ケーキ","ケース","ゲーム","コック","コップ","コピー","コミュニケーション","コレクション","コンサート","コンセント","コンビニ","コンピューター","コース","コーチ","コート","コード","コーヒー","コーラス","コール","ゴム","ゴール","サイズ","サイレン","サイン","サッカー","サラダ","サラリーマン","サンダル","サンドイッチ","サンプル","サービス","シャッター","シャツ","シャワー","ショップ","シリーズ","シーズン","シーツ","ジャム","ジャーナリスト","ジュース","ジョギング","ジーンズ","スイッチ","スカート","スカーフ","スキー","スクリーン","スクール","スケジュール","スケート","スタイル","スター","スタート","ステレオ","ステーキ","ステージ","ストッキング","ストップ","ストレス","ストーブ","ストーリー","スピーカー","スピーチ","スピード","スプーン","スポンサー","スポーツ","スーツ","スーパー","スープ","ズボン","セット","センター","セーター","セール","ゼロ","ソファー","ソフト","ソース","タイア","タイプ","タイプライター","タイヤ","タオル","タクシー","タバコ","ダイエット","ダイヤ","ダイヤモンド","ダンス","チェック","チケット","チーズ","チーム","テキスト","テスト","テニス","テレビ","テント","テンポ","テーブル","テーマ","デザート","デパート","データ","デート","トイレ","トップ","トラック","トランプ","ドア","ドライブ","ドラマ","ドレス","ナイフ","ナンバー","ニュース","ネクタイ","ネット","ノート","ハイキング","ハンカチ","ハンドバッグ","ハンドル","ハンバーグ","ハート","バイオリン","バイク","バイト","バケツ","バス","バター","バック","バッグ","バランス","バンド","パイプ","パイロット","パスポート","パソコン","パターン","パン","パンツ","パーティー","ビタミン","ビデオ","ビル","ビール","ピアノ","ピクニック","ピンク","ピンポン","ファイル","ファスナー","ファックス","ファーストフード","フィルム","フォーク","フライパン","フルーツ","ブラウス","ブラシ","ブレーキ","ブローチ","ブーム","プラス","プラスチック","プラン","プリント","プレゼント","プロ","プログラム","プール","ベッド","ベル","ベルト","ベンチ","ペット","ペン","ページ","ホテル","ホーム","ホームページ","ボタン","ボート","ボーナス","ボール","ポケット","ポスター","マイク","マイナス","マスク","マスター","マッチ","ママ","マラソン","マンション","マーケット","ミシン","ミルク","メニュー","メモ","メリット","メロン","メンバー","メートル","モデル","モーター","ユーモア","ヨット","ヨーロッパ","ライオン","ライター","ライト","ラケット","ラジオ","ランチ","リサイクル","リズム","リットル","リボン","リポート","リーダー","レコード","レストラン","レベル","レンタル","ロケット","ロボット","ワイン","ワンピース"];
  const katakananame = [
  "キムテヒョン","チョングク","ジミン","パクジフン","キムナムジュン",
  "ミンユンギ","チョンジョングク","パクソジュン","イミノ","ソンジュンギ",
  "チャウヌ","チョンヘイン","イジョンソク","パクボゴム","カンダニエル",
  "オンサンウ","キムウソク","ファンミンヒョン","ベッキョン","チャニョル",
  "キムジス","ジス","ジェニ","ロゼ","リサ",
  "アイユー","テヨン","ソヒョン","スジ","アイリン",
  "ジョイ","イェリ","ユナ","ティファニー","ソルヒョン",
  "ヒョナ","チョンハ","ダヒョン","サナ","モモ",
  "ソンヘギョ","キムテリ","パクシネ","チョンジヒョン","ハンジミン",
  "イボヨン","キムソヒョン","キムユジョン","スエ","コソヨン",
  "チョンウソン","ウォンビン","イビョンホン","ハジョンウ","コンユ",
  "チョインソン","パクソジュン","キムウビン","イジュンギ","ヒョンビン",
  "ジン","シュガ","ジェイホープ","アールエム","ブイ",
  "ジミン","チョングク","エスクプス","ジョンハン","ミンギュ",
  "チャンウォニョン","チョユリ","ミヤワキサクラ","アイリン","スルギ",
  "ウェンディ","ジョイ","ナヨン","ジョンヨン","モモ",
  "パクヘジン","チョジョンソク","キムレウォン","ユヨンソク","ユンゲサン",
  "イソンミン","チャンドンゴン","ソルギョング","チョスンウ","チョンウ",
  "カンジヨン","キムジェジュン","パクジョンミン","ユスンホ","イジュン",
  "チョイカンチャンミン","キムジェファン","キムセジョン","ムンガヨン","シンセギョン"
];


  let currentStage = 1;
  let words = [];
  let displayWords = [];
  let current = 0;
  let correct = 0;
  let incorrect = 0;
  let wrongList = [];
  let roundCount = 10;
  let timeLimit = 15;
  let timerInterval;
  let answered = false;

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  const stages = {
    1: { name: "1단계: 가타카나 연습", getWords: () => katakana, isPractice: false },
    2: { name: "2단계: 요음 연습", getWords: () => halfKatakanapractice, isPractice: true },
    3: { name: "3단계: 요음 테스트", getWords: () => halfKatakana, isPractice: false },
    4: { name: "4단계: 단어 테스트", getWords: () => fullWords, isPractice: false },
    5: { name: "5단계: 이름 테스트", getWords: () => katakananame, isPractice: false }
  };

  window.onload = function() {
    const btnContainer = document.getElementById("stageButtons");
    for (let key in stages) {
      const btn = document.createElement("button");
      btn.textContent = `▶ ${stages[key].name}`;
      btn.onclick = () => startGame(parseInt(key));
      btnContainer.appendChild(btn);
    }
      document.getElementById('logo').addEventListener('click', restartGame);

  };

  function startGame(stage) {
    roundCount = parseInt(document.getElementById("roundCount").value, 10) || 10;
    timeLimit = parseInt(document.getElementById("timeLimit").value, 10) || 15;

    currentStage = stage;
    document.getElementById("stageButtons").style.display = "none";

    if (stages[stage]) {
      let stageWords = stages[stage].getWords().slice();
      shuffle(stageWords);
      displayWords = stageWords.slice(0, roundCount);

      if (stages[stage].isPractice) {
        words = displayWords.map(w => w.split(" ")[0]);
      } else {
        words = displayWords;
      }
    } else {
      alert("존재하지 않는 단계입니다!");
      return;
    }

    current = 0;
    correct = 0;
    incorrect = 0;
    wrongList = [];
    document.getElementById('result').style.display = 'none';
    document.getElementById('game').style.display = 'block';
    nextQuestion();
  }

  function nextQuestion() {
    if (current >= words.length) {
      endGame();
      return;
    }

    document.getElementById('input').value = '';
    document.getElementById('feedback').innerText = '';

    if (stages[currentStage].isPractice) {
      const [kana, romaji] = displayWords[current].split(" ");
      document.getElementById('question').innerHTML = `<span class="kana">${kana}</span><span class="romaji">${romaji}</span>`;
    } else {
      document.getElementById('question').innerText = displayWords[current];
    }

    let timeLeft = timeLimit;
    answered = false;
    updateTimer(timeLeft);

    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      timeLeft--;
      updateTimer(timeLeft);
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        markWrong("⏱️ 시간 초과!", "", words[current]);
      }
    }, 1000);
  }

  function updateTimer(t) {
    document.getElementById('timer').innerText = t;
  }

  function handleKey(event) {
    if (event.key === 'Enter') {
      checkInput();
    }
  }

  function checkInput() {
    const input = document.getElementById('input').value.trim();
    if (!answered && input === words[current]) {
      answered = true;
      clearInterval(timerInterval);
      document.getElementById('feedback').innerText = '⭕ 정답!';
      correct++;
      current++;
      setTimeout(nextQuestion, 1000);
    } else if (!answered) {
      answered = true;
      clearInterval(timerInterval);
      markWrong("❌ 오답!", input, words[current]);
    }
  }

  function markWrong(message, inputValue, correctAnswer) {
    document.getElementById('feedback').innerText = `${message} 정답: ${correctAnswer}`;
    incorrect++;
    wrongList.push({ question: correctAnswer, answer: inputValue || "(미입력)" });
    current++;
    setTimeout(nextQuestion, 1500);
  }

  function endGame() {
    document.getElementById('game').style.display = 'none';

    let wrongDetails = "";
    if (wrongList.length) {
      wrongDetails = "<br>❌ 틀린 문제:<br>";
      wrongList.forEach((item, idx) => {
        wrongDetails += `${idx + 1}. 문제: ${item.question} | 입력: ${item.answer}<br>`;
      });
    } else {
      wrongDetails = "<br>모든 문제를 맞췄습니다!";
    }

    const resultText = `🎉 게임 종료!<br>
      ✅ 정답 수: ${correct}<br>
      ❌ 오답 수: ${incorrect}<br>
      ${wrongDetails}`;

    document.getElementById('resultText').innerHTML = resultText;
    document.getElementById('result').style.display = 'block';
  }

  function restartGame() {
    document.getElementById("stageButtons").style.display = "flex";
    document.getElementById('result').style.display = 'none';
  }
</script>

</body>
</html>
